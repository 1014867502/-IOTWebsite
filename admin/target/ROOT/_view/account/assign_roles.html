<!DOCTYPE html>
<html>
<head>
  #@meta("账户管理/分配角色")
</head>
<body>
  <div class="layui-fluid">
    <div class="layui-card">
      <div class="layui-card-header" data-locale="web_role_assignment">账户管理 / 分配角色</div>
      <div class="layui-card-body" style="padding: 15px;">
        <div class="layui-fluid layui-form" lay-filter="myForm">
        <div class="layui-card">
          <div class="layui-card-header">#(account.nickName)</div>
          <div class="layui-card-body" style="padding: 15px;">
                    <table class="layui-table">
                      <tbody>
                      #for(x : roleList)
                        <tr>
                          <td width="100"><input type="checkbox"
                                     data-account-id="#(account.id)"
                                     data-role-id="#(x.id)"
                                     lay-skin="switch" lay-text="ON|OFF"
                                     lay-filter="account-role"
                                     #if(x.assigned) checked #end>
                          </td>
                          <td>#(x.name)</td>
                        </tr>
                      #end
                      </tbody>
                    </table>
            </div>
        </div>
        </div>
      </div>
    </div>

    <!-- 底部按钮 -->
    <div class="layui-form-item layui-layout-admin">
      <div class="layui-input-block">
        <div class="layui-footer" style="left: 0;">
          <button class="layui-btn layui-btn-primary" id="returnBtn" lay-filter="returnBtn" data-locale="web_item_return">返回</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/assets/lib/jquery-3.4.1.min.js"></script>
  <script src="/assets/lib/jquery.i18n.properties-min.js"></script>
  <script src="/assets/lib/loadlanguage.js"></script>
  <script src="/assets/layuiadmin/layui/layui.js"></script>
  <script>
  layui.config({
    base: '/assets/layuiadmin/' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['index', 'account'], function(){
    var $ = layui.$
    ,admin = layui.admin
    ,form = layui.form;

    form.on('switch(account-role)',function (obj) {
        var state = obj.elem.checked ? true : false;
        var data = {
            roleId: $(this).data('roleId'),
            accountId: $(this).data('accountId')
        };
        var url = state ? '/account/addRole' : '/account/deleteRole';
        admin.req({
            url:url,
            data:data
        })
    });
  });
  </script>
</body>
</html>
