<!DOCTYPE html>
<html>
<head>
    #@meta(APP.name)
    <style>
        .layui-layout-admin.layui-header {
            background-color: rgba(24, 24, 87, 0.79);
        }

        .layui-nav-tree .layui-nav-bar {
            background-color:#e7efef ;
        }
        .layui-layout-admin .layui-header .layui-nav .layui-nav-more {
            border-top-color: #333333 !important;
        }
    </style>
</head>
<body class="layui-layout-body">

<div id="homecover"
     style="background: #000; position: absolute; left: 0px; top: 0px; width: 100%; filter: alpha(opacity=30); opacity: 0.3; display: none; z-index: 2 "></div>

<div id="LAY_app">
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header" style="background-color: #ffFFFF;">
            <!-- 头部区域 -->
            #include("/_view/_common/_header.html")
        </div>
        <!-- 侧边菜单 -->
        <div class="layui-side layui-side-menu">
            #include("/_view/_common/_menu.html")
        </div>
        <!-- 页面标签 -->
        <div class="layadmin-pagetabs" id="LAY_app_tabs">
            <div class="layui-icon layadmin-tabs-control layui-icon-prev" layadmin-event="leftPage"></div>
            <div class="layui-icon layadmin-tabs-control layui-icon-next" layadmin-event="rightPage"></div>
            <div class="layui-icon layadmin-tabs-control layui-icon-down">
                <ul class="layui-nav layadmin-tabs-select" lay-filter="layadmin-pagetabs-nav">
                    <li class="layui-nav-item" lay-unselect>
                        <a href="javascript:"></a>
                        <dl class="layui-nav-child layui-anim-fadein">
                            <dd layadmin-event="closeThisTabs"><a href="javascript:" data-locale="web_index_close_cur">关闭当前标签页</a>
                            </dd>
                            <dd layadmin-event="closeOtherTabs"><a href="javascript:"
                                                                   data-locale="web_index_close_other">关闭其它标签页</a></dd>
                            <dd layadmin-event="closeAllTabs"><a href="javascript:" data-locale="web_index_close_all">关闭全部标签页</a>
                            </dd>
                        </dl>
                    </li>
                </ul>
            </div>
            <div class="layui-tab" lay-unauto lay-allowClose="true" lay-filter="layadmin-layout-tabs">
                <ul class="layui-tab-title" id="LAY_app_tabsheader">
                    <li lay-id="/manage/dashboard" lay-attr="/dashboard" class="layui-this"><i
                            class="layui-icon layui-icon-home"></i></li>
                </ul>
            </div>
        </div>
        <!-- 主体内容 -->
        <div class="layui-body" id="LAY_app_body">
            <div class="layadmin-tabsbody-item layui-show">
                <iframe src="/projectindex" frameborder="0" class="layadmin-iframe" userid="#(userid)" writeright="#(writeright)" name="homepageiframe"></iframe>
            </div>
        </div>
        <!-- 辅助元素，一般用于移动设备下遮罩 -->
        <div class="layadmin-body-shade" layadmin-event="shade"></div>
    </div>
</div>
<script src="/assets/lib/jquery-3.4.1.min.js"></script>
<script src="/assets/lib/jquery.i18n.properties-min.js"></script>
<script src="/assets/lib/loadlanguage.js"></script>
<script src="/assets/layuiadmin/layui/layui.js"></script>
<script>
    var projectid="#(projetid)";
    var writeright="#(writeright)";
    var userid="#(userid)";
    var agentnum="#(agentnum)";

    layui.config({
        base: '/assets/layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index','common'], function () {
        var $ = layui.$
            , admin = layui.admin
            , layer = layui.layer
            , href = window.location.hash.substr(1);

        href && tooDestinationMenu(href);

        $('#projectselect').addClass('layui-hide');
        //$('#projectselect').hide();
        // //查询GNSS在线情况
        // admin.req({
        //   url:'/manage/projectlocation',
        //   done:function (res) {
        //     assignGnssState(res.data);
        //     return false;
        //   }
        // })
        adaptauthority();

        function adaptauthority(){
            $.ajax({
                url:'/custom/getauthorById',
                async:false,
                success:function (data) {
                    switch (data.data) {
                        case "user":
                            document.getElementById("companymanage").style.display="none";
                            document.getElementById("devicemanage").style.display="none";
                            document.getElementById("usermanage").style.display="none";
                            document.getElementById("orderlogmanage").style.display="none";
                            break;
                        case "companyadmin":
                            document.getElementById("changePassword").style.display="none";
                            document.getElementById("companymanage").style.display="none";
                            document.getElementById("devicemanage").style.display="none";
                            document.getElementById("usermanage2").setAttribute("lay-href","/manage/comusermanage");
                            $("#projectmanage a").attr("lay-href","/company/CompanyDetail?agentNumber="+agentnum);
                            break;
                        case "superadmin":
                            document.getElementById("changePassword").style.display="none";
                            document.getElementById("devicemanage").style.display="none";
                            document.getElementById("projectmanage").style.display="none";
                            break;
                        case "admin":
                                document.getElementById("changePassword").style.display="none";
                                document.getElementById("devicemanage").style.display="none";
                                document.getElementById("projectmanage").style.display="none";
                            document.getElementById("usermanage2").setAttribute("lay-href","/manage/comadminmanage");
                                break;
                    }
                }
            })
        }

    });

</script>
</body>
</html>
